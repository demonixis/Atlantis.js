<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <title>Atlantis Game Engine</title>
</head>
<body>
<script>
    requestAnimationFrame = window.requestAnimationFrame || mozRequestAnimationFrame;
</script>
<!-- Framework -->
<script src="../../Framework/ContentManager.js"></script>
<script src="../../Framework/GameComponent.js"></script>
<script src="../../Framework/Graphics.js"></script>
<script src="../../Framework/Helpers.js"></script>
<script src="../../Framework/Rectangle.js"></script>
<script src="../../Framework/Vector2.js"></script>
<script src="../../Framework/Input/KeyboardManager.js"></script>
<script src="../../Framework/Input/PointerManager.js"></script>
<script src="../../Framework/Game.js"></script>
<!-- Engine -->
<script src="../../Engine/AudioManager.js"></script>
<script src="../../Engine/GameApplication.js"></script>
<script src="../../Engine/StateManager.js"></script>
<script src="../../Engine/Display/Animation.js"></script>
<script src="../../Engine/Display/Entity.js"></script>
<script src="../../Engine/Display/SpriteGroup.js"></script>
<script src="../../Engine/Display/Sprite.js"></script>
<!-- In production use the compiled version
<script src="../../Build/AtlantisEngine.js"></script>
-->

<script>
var Game = function () {
	Atlantis.Game.call(this, 640, 480);
	
	var tilemap = this.content.load("Content/tileset.png");
	
	var map = [
		[5, 6, 6, 7],
		[10, 18, 18, 12],
		[10, 8, 9, 12],
		[10, 13, 14, 12],
		[15, 16, 16, 17]
	];
	
	var tile = {
		width: 32,
		height: 32,
		numOnX: 5,
		numOnY: 4
	};
	
	this.draw = function (gameTime, context) {
		Atlantis.Game.prototype.draw.call(this, gameTime, context); 
		
		for (var y = 0; y < map.length; y++) {
			for (var x = 0; x < map[0].length; x++) {
				
				var sx = map[y][x] % tile.numOnX;
                var sy = Math.floor(map[y][x] / tile.numOnX);

                if (sy > 0) {
                    sx = sx % (tile.numOnX * sy);
                }
                else {
                    sx = sx % tile.numOnX; 
                }
				sx *= tile.width;
				sy *= tile.height;
				
				context.drawImage(tilemap, sx, sy, tile.width, tile.height, x * tile.width, y * tile.height, tile.width, tile.height);
			}
		}
	};
};

Game.prototype = new Atlantis.Game();
</script>
<script>
    var game = new Game();

    (function loop() {
        requestAnimationFrame(loop);
        game.run();
    })();
</script>
</body>
</html>