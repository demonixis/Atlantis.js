<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <title>AtlantisEngine.js - Samples</title>
        <style>
            html, body { margin: 0; padding: 0; border: 0; }
        </style>
    </head>
    <body>
        <!-- Framework -->
        <script src="../../Framework/Compatibility.js"></script>
        <script src="../../Framework/ContentManager.js"></script>
        <script src="../../Framework/GameComponent.js"></script>
        <script src="../../Framework/GameTime.js"></script>
        <script src="../../Framework/Helpers.js"></script>
        <script src="../../Framework/MathHelper.js"></script>
        <script src="../../Framework/Rectangle.js"></script>
        <script src="../../Framework/Matrix.js"></script>
        <script src="../../Framework/Quaternion.js"></script>
        <script src="../../Framework/Vector2.js"></script>
        <script src="../../Framework/Vector3.js"></script>
        <script src="../../Framework/Vector4.js"></script>
        <script src="../../Framework/Input/KeyboardManager.js"></script>
        <script src="../../Framework/Input/PointerManager.js"></script>
        <script src="../../Framework/Input/Keys.js"></script>
        <script src="../../Framework/Graphics/GraphicsDevice.js"></script>
        <script src="../../Framework/Graphics/Texture2D.js"></script>
        <script src="../../Framework/Graphics/RenderTarget.js"></script>
        <script src="../../Framework/Graphics/SpriteBatch.js"></script>
        <script src="../../Framework/Game.js"></script>
        <!-- Engine -->
        <script src="../../Engine/AudioManager.js"></script>
        <script src="../../Engine/StateManager.js"></script>
        <script src="../../Engine/Graphics/Animation.js"></script>
        <script src="../../Engine/Graphics/Sprite.js"></script>
        <script src="../../Engine/Graphics/SpriteGroup.js"></script>
        <script src="../../Engine/Input/KeyboardComponent.js"></script>
        <script src="../../Engine/GameApplication.js"></script>
    </body>
    <script>
        // The Game class
        var TestGame = function () {
            Atlantis.Game.call(this, 1024, 768, null, { backBufferWidth: 640, backBufferHeight: 480 });
            this.content.setRootDirectory("Content/");
            this.spriteBatch = new Atlantis.SpriteBatch(this.graphicsDevice);
            this.spriteA = null;
            this.textA = null;
            this.position = { x: 50, y: 50 };
            this.rotation = 0;
        };
        TestGame.prototype = new Atlantis.GameApplication();

        // Initialize you object here. 
        TestGame.prototype.initialize = function () {
            Atlantis.GameApplication.prototype.initialize.call(this);
        };
    
        // Load you assets here.
        TestGame.prototype.loadContent = function () {
            Atlantis.GameApplication.prototype.loadContent.call(this);
            
            var that = this;
            this.spriteA = this.content.load("atlantis_logo.jpg", function () {
                that.spriteA.width = 32;
                that.spriteA.height = 32;
            });
            this.textA = new Atlantis.SpriteFont();
        };

        // Update the game logic here as Input, Physics, etc...
        TestGame.prototype.update = function (gameTime) {
            Atlantis.GameApplication.prototype.update.call(this, gameTime);
        
            var state = this.keyboard.getState();
          
            if (state.isKeyDown(Atlantis.Keys.Up))
                this.position.y -= 5;
            else if (state.isKeyDown(Atlantis.Keys.Down))
                this.position.y += 5;
            
            if (state.isKeyDown(Atlantis.Keys.Left))
                this.position.x -= 5;
            else if (state.isKeyDown(Atlantis.Keys.Right))
                this.position.x += 5;
            
            if (state.isKeyDown(Atlantis.Keys.Space))
                this.rotation += 0.1;
            else if (state.isKeyDown(Atlantis.Keys.Tab))
                this.rotation -= 0.1;
        };

        // Draw sprites and text here.
        TestGame.prototype.draw = function (gameTime, context) {
            Atlantis.GameApplication.prototype.draw.call(this, gameTime, context);
            this.graphicsDevice.clear(); 
         
            this.spriteBatch.begin(Atlantis.SpriteSortMode.FrontToBack);
            
            // Draw simple texts.
            this.spriteBatch.drawString(this.textA, "SpriteBatch test", { x: 10, y: 15 }, "#459999");
            
            this.spriteBatch.drawString(this.textA, Math.round(gameTime.getFPS()) + " FPS", { x: this.graphicsDevice.preferredBackBufferWidth - 50, y: 15 }, "#459999");
            
            this.spriteBatch.drawString(this.textA, "Scaled text", { x: 10, y: this.graphicsDevice.preferredBackBufferHeight - 50 }, "#4599FF", 0, { x: 0, y: 0 }, { x: 7, y: 2 }, Atlantis.SpriteEffect.None);
            
            this.spriteBatch.draw(this.spriteA, this.position, null, null, this.rotation, { x: this.spriteA.width >> 1, y: this.spriteA.height >> 1 }, null, null, null, -45);
            
            this.spriteBatch.draw(this.spriteA, { x: 150, y: 100 }, null, null, this.rotation, { x: 0, y: 0 }, { x: 1, y: 1 }, Atlantis.SpriteEffect.None, 2);
            
            this.spriteBatch.draw(this.spriteA, { x: 150, y: 150 }, null, null, this.rotation, { x: 0, y: 0 }, { x: 1, y: 1 }, Atlantis.SpriteEffect.None, 3);
            
            this.spriteBatch.draw(this.spriteA, { x: 150, y: 200 }, null, null, this.rotation, { x: 0, y: 0 }, { x: 2, y: 3 }, Atlantis.SpriteEffect.FlipHorizontaly, 3);
            
            this.spriteBatch.draw(this.spriteA, { x: 150, y: 250 }, null, null, this.rotation, { x: 0, y: 0 }, { x: 2, y: 1.5}, Atlantis.SpriteEffect.None, 4);
            
            this.spriteBatch.draw(this.spriteA, { x: 150, y: 300 }, null, null, this.rotation, { x: this.spriteA.width >> 1, y: this.spriteA.height >> 1 }, { x: 3, y: 1 }, Atlantis.SpriteEffect.FlipHorizontaly, 3); 
            
            this.spriteBatch.draw(this.spriteA, { x: 150, y: 350 }, null, null, this.rotation, { x: this.spriteA.width >> 1, y: this.spriteA.height >> 1 }, { x: 4, y: 0.5 }, Atlantis.SpriteEffect.FlipVerticaly, 1);  
            
            // Draw all of this in the screen
            this.spriteBatch.end();
        };
    
        // Start the game !
        var game = new TestGame();
        game.run();
    </script>
</html>
