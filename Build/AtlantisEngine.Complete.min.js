var Atlantis=window.Atlantis||{};
Atlantis.ContentManager=function(){function b(a,b,e){if("undefined"!=typeof Atlantis.ajax)return Atlantis.ajax({method:"GET",url:b,success:function(g){var f=g;"json"==e&&(f=JSON.parse(g));a[b]=f}}),a[b];console.error("[Content] Impossible to load the resource becanse the Atlantis.Helper class isn't loaded")}var a=function(a){this.rootDirectory=a||"";this.assets=[]};a.prototype.load=function(a){if("undefined"==typeof this.assets[a]){var d=a.split("."),d=d[d.length-1];switch(d){case "png":case "jpg":case "bmp":var d=
this.assets,e=new Image;e.src=a;d[a]=e;break;case "mp3":case "ogg":case "wav":d=this.assets;e=document.createElement("audio");e.src=a;e.controls=!1;d[a]=e;break;case "mp4":case "ogv":var e=this.assets,g=document.createElement("video");g.src=a;e[a]=g;case "xml":case "json":case "js":b(this.assets,a,d)}}return this.assets[a]};a.prototype.dispose=function(){this.assets.length=0};return a}();Atlantis=window.Atlantis||{};Atlantis.GameComponent=function(){var b=function(a){this.game=a;this.enabled=this.visible=!0};b.prototype.isActive=function(){return this.visible&&this.enabled};b.prototype.setActive=function(a){this.visible=this.enabled=a};b.prototype.initialize=function(){};b.prototype.update=function(a){};return b}();
Atlantis.DrawableGameComponent=function(){var b=function(a){Atlantis.GameComponent.call(this,a)};b.prototype=new Atlantis.GameComponent;b.prototype.draw=function(a,c){};return b}();
Atlantis.GameComponentCollection=function(){var b=function(){this.components=[];this.drawables=[]};b.prototype.add=function(a){-1==this.components.indexOf(a)&&(this.components.push(a),a instanceof Atlantis.DrawableGameComponent&&this.drawables.push(a))};b.prototype.get=function(a){this.components.indexOf(gameComponent);return null};b.prototype.remove=function(a){var c=this.components.indexOf(a);-1<c&&(this.components.splice(c,1),a instanceof Atlantis.DrawableGameComponent&&(c=this.drawables.indexOf(a),
-1<c&&this.drawables.splice(c,1)))};b.prototype.initialize=function(a){a=0;for(var c=this.components.length;a<c;a++)this.components[a].initialize()};b.prototype.loadContent=function(a){for(var c=0,b=this.drawables.length;c<b;c++)this.drawables[c].loadContent(a)};b.prototype.update=function(a){for(var c=0,b=this.components.length;c<b;c++)this.components[c].enabled&&this.components[c].update(a)};b.prototype.draw=function(a,c){for(var b=0,e=this.drawables.length;b<e;b++)this.drawables[b].visible&&this.drawables[b].draw(a,
c)};return b}();Atlantis=window.Atlantis||{};Atlantis.Graphics=Atlantis.Graphics||{};(function(){Atlantis.Graphics.drawCircle=function(b,a,c,d,e){b.beginPath();b.arc(a,c,d,0,2*Math.PI,!0);b.fillStyle=e||"#ffffff";b.fill()};Atlantis.Graphics.drawRectPoint=function(b,a,c,d,e,g){b.fillStyle=g||"#ffffff";b.fillRect(a,c,d,e)};Atlantis.Graphics.drawText=function(b,a,c,d,e){e=e||{};var g=e.style||"normal",f=e.size||12,h=e.font||"sans-serif";b.fillStyle=e.color||"#ffffff";b.font=g+" "+f+"px "+h;b.fillText(a,c,d)}})();Atlantis=window.Atlantis||{};
(function(){var b=[];Atlantis.ajax=function(a){var c=a.params||{},b=a.url,e=a.method||"GET",g=a.success||function(){};a="undefined"!=typeof a.async?a.async:!0;var f;"undefined"!==typeof WinJS?WinJS.xhr({url:b}).then(g):(f=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"),"POST"==e?(f.open("POST",b,a),f.setRequestHeader("Content-type","application/x-www-form-urlencoded"),f.setRequestHeader("Content-length",c.length),f.setRequestHeader("Connection","close"),f.onreadystatechange=
function(){4==f.readyState&&200==f.status&&null!=g&&g(f.responseText)},f.send(c)):(f.open("GET",""!=c?b+"?"+c:b,a),f.onreadystatechange=function(){4==f.readyState&&null!=g&&g(f.responseText)},f.send(null)))};Atlantis.notify=function(a,c){if("undefined"!=typeof b[a]){var d=b[a];if(c instanceof Object)for(var e in c)d[e]=c[e];document.dispatchEvent(d)}else return b[a]=document.createEvent("HTMLEvents"),b[a].initEvent(a,!0,!1),Atlantis.notify(a,c)};Atlantis.getImageSize=function(a){a.style.position=
"absolute";a.style.left="-9999px";document.body.appendChild(a);document.body.removeChild(a);a.style.position="";a.style.left=""}})();Atlantis=Atlantis||{};Atlantis.Point=function(){return function(b,a){b instanceof Atlantis.Point?(this.x=b.x,this.y=b.y):(this.x=b||0,this.y=a||0)}}();
Atlantis.Rectangle=function(){var b=function(a,c,b,e){a instanceof Atlantis.Rectangle?(this.x=a.x,this.y=a.y,this.width=a.width,this.height=a.height):(this.x=a||0,this.y=c||0,this.width=b||0,this.height=e||0)};b.prototype.getTop=function(){return this.y};b.prototype.getBottom=function(){return this.y+this.height};b.prototype.getLeft=function(){return this.x};b.prototype.getRight=function(){return this.x+this.width};b.prototype.getCenter=function(){return new Atlantis.Point(this.x+this.width/2,this.y+
this.height/2)};b.prototype.contains=function(a){return a instanceof Atlantis.Point?this.x<=a.x&&a.x<this.getRight()&&this.y<=a.y&&a.y<this.getBottom():a instanceof Atlantis.Rectangle?this.x<=a.x&&a.getRight()<=this.getRight()&&this.y<=a.y&&a.getBottom()<=this.getBottom():!1};b.prototype.intersects=function(a){return a.getLeft()<this.getRight()&&this.getLeft()<a.getRight()&&a.getTop()<this.getBottom()&&this.getTop()<a.getBottom()};return b}();Atlantis=window.Atlantis||{};
Atlantis.Vector2=function(){var b=function(a,c){a instanceof Atlantis.Vector2?(this.x=a.x,this.y=a.y):(this.x=a||0,this.y=c||0)};b.prototype.add=function(a){a instanceof Atlantis.Vector2?(this.x+=a.x,this.y+=a.y):(this.x+=a,this.y+=a)};b.add=function(a,c){var b=new Atlantis.Vector2(a);b.add(c);return b};b.prototype.subtract=function(a){a instanceof Atlantis.Vector2?(this.x-=a.x,this.y-=a.y):(this.x-=a,this.y-=a)};b.subtract=function(a,c){var b=new Atlantis.Vector2(a);b.subtract(c);return b};b.prototype.divide=
function(a){a instanceof Atlantis.Vector2?(this.x/=a.x,this.y/=a.y):(this.x/=a,this.y/=a)};b.divide=function(a,c){var b=new Atlantis.Vector2(a);b.divide(c);return b};b.prototype.multiply=function(a){a instanceof Atlantis.Vector2?(this.x*=a.x,this.y*=a.y):(this.x*=a,this.y*=a)};b.multiply=function(a,c){var b=new Atlantis.Vector2(a);b.multiply(c);return b};b.prototype.distance=function(a){var c=this.x-a.x;a=this.y-a.y;return Math.sqrt(c*c+a*a)};b.distance=function(a,c){return(new b(a)).distance(c)};
b.prototype.distance=function(a){var c=this.x-a.x;a=this.y-a.y;return Math.sqrt(c*c+a*a)};b.dot=function(a,c){return a.x*c.x+a.y*c.y};b.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)};b.lerp=function(a,c,b){return new Atlantis.Vector2(Atlantis.MathHelper.lerp(a.x,c.x,amount),Atlantis.MathHelper.lerp(c.y,c.y,amount))};b.min=function(a,c){var b=new Atlantis.Vector2;b.x=a.x<c.x?a.x:c.x;b.y=a.y<c.y?a.y:c.y;return b};b.max=function(a,c){var b=new Vector2;b.x=a.x>c.x?a.x:c.x;
b.y=a.y>c.y?a.y:c.y;return b};b.prototype.negate=function(a){a instanceof Atlantis.Vector2?(this.x=-a.x,this.y=-a.y):(this.x=-a,this.y=-a)};b.negate=function(a){a=new Atlantis.Vector2(a);a.x*=-1;a.y*=-1;return a};b.prototype.normalize=function(){var a=Atlantis.Vector3.distance(this,new Vector3);0!=a&&(a=1/a,this.set(this.x*a,this.y*a,this.z*a))};b.normalize=function(a){a=new b(a);a.normalize();return a};b.transform=function(a,c){return new Atlantis.Vector3(a.x*c.M11+a.y*c.M21+a.z*c.M31+c.M41,a.x*
c.M12+a.y*c.M22+a.z*c.M32+c.M42,a.x*c.M13+a.y*c.M23+a.z*c.M33+c.M43)};b.transformCoordinate=function(a,c){var b=new Atlantis.Vector4;b.x=a.x*c.M11+a.y*c.M21+a.z*c.M31+c.M41;b.y=a.x*c.M12+a.y*c.M22+a.z*c.M32+c.M42;b.z=a.x*c.M13+a.y*c.M23+a.z*c.M33+c.M43;b.w=1/(a.x*c.M14+a.y*c.M24+a.z*c.M34+c.M44);return new Vector3(b.x*b.w,b.y*b.w,b.z*b.w)};b.prototype.set=function(a,b){this.x=a;this.y=b};b.prototype.toString=function(){return["x: ",this.x," y: ",this.y].join("")};return b}();Atlantis=window.Atlantis||{};Atlantis.Keys={up:38,down:40,left:37,right:39,space:32,escape:27};Atlantis.KeyboardState=function(){}();
Atlantis.KeyboardManager=function(){var b=null,a=function(a){this.keys=[];this.maxKeys=a||110;for(var d=0;d<a;d++)this.keys[d]=!1;this.preventDefault=!0;b=this};a.prototype.initialize=function(){document.addEventListener("keydown",this.onKeyStateChange,!1);document.addEventListener("keyup",this.onKeyStateChange,!1)};a.prototype.getState=function(){return new Atlantis.KeyboardState(this.keys)};a.prototype.onKeyStateChange=function(a){b.preventDefault&&a.preventDefault();b.keys[a.keyCode]="keydown"==
a.type?!0:!1};return a}();Atlantis=window.Atlantis||{};
Atlantis.PointerManager=function(){var b,a=function(a){this.y=this.x=0;this.lastState={x:0,y:0};this.delta={x:0,y:0};this.click=!1;this.release=!0;this.drag=!1;this.hasTouch=!!("ontouchstart"in window)||!!("onmsgesturechange"in window);this.touch=!1;this.domElement=a;this.initialized=!1;this.startEventListeners();b=this};a.prototype.startEventListeners=function(){this.initialized||(this.domElement.addEventListener("mousedown",this.updateHandler,!1),this.domElement.addEventListener("mousemove",this.updateHandler,
!1),this.domElement.addEventListener("mouseup",this.updateHandler,!1),this.domElement.addEventListener("click",this.updateHandler,!1),this.domElement.addEventListener("touchstart",this.updateHandler,!1),this.domElement.addEventListener("touchmove",this.updateHandler,!1),this.domElement.addEventListener("touchend",this.updateHandler,!1),this.domElement.addEventListener("touchcancel",this.updateHandler,!1),this.initialized=!0)};a.prototype.stopEventListeners=function(){this.initialized&&(this.domElement.removeEventListener("mousedown",
this.updateHandler),this.domElement.removeEventListener("mousemove",this.updateHandler),this.domElement.removeEventListener("mouseup",this.updateHandler),this.domElement.removeEventListener("click",this.updateHandler),this.domElement.removeEventListener("touchstart",this.updateHandler),this.domElement.removeEventListener("touchmove",this.updateHandler),this.domElement.removeEventListener("touchend",this.updateHandler),this.domElement.removeEventListener("touchcancel",this.updateHandler),this.initialized=
!1)};a.prototype.updatePosition=function(a){var d=a;"undefined"!==typeof a.touches&&0<a.touches.length&&(d=a.touches[0]);a=d;b.lastState.x=b.x;b.lastState.y=b.y;b.x=a.pageX;b.y=a.pageY};a.prototype.updateClickStates=function(a){a=a||{};"mousedown"==a.type||"touchstart"==a.type?(b.click=!0,b.release=!1,b.touch=b.hasTouch?!0:!1):"mousemove"==a.type||"touchmove"==a.type?b.drag=b.click?!0:!1:(b.click=!1,b.release=!0,b.drag=!1,b.touch=!1)};a.prototype.updateHandler=function(a){a.preventDefault();b.updatePosition(a);
b.updateClickStates(a);b.updateDelta()};a.prototype.updateDelta=function(){b.delta.x=b.x==b.lastState.x?0:b.x-b.lastState.x;b.delta.y=b.y==b.lastState.y?0:b.y-b.lastState.y;100<b.delta.x&&(b.delta.x=0);b.delta.x=50<b.delta.x?0:b.delta.x;b.delta.y=50<b.delta.y?0:b.delta.y};return a}();Atlantis=window.Atlantis||{};Atlantis.MusicState={};
Atlantis.AudioManager=function(){Atlantis.MusicState.PLAYING=1;Atlantis.MusicState.STOPPED=2;Atlantis.MusicState.PAUSED=3;var b=function(){this.repeatMusic=!1;this.currentMusic=null;this.volume=1;this.currentState=Atlantis.MusicState.STOPPED};b.prototype.playMusic=function(a,b){this.stopMusic();this.currentMusic=a;this.repeat=b;this.currentMusic.play();this.currentState=Atlantis.MusicState.PLAYING};b.prototype.stopMusic=function(){this.currentState=Atlantis.MusicState.STOPPED};b.prototype.pauseMusic=
function(){null!=this.currentMusic&&this.currentState==Atlantis.MusicState.PLAYING&&(this.currentMusic.pause(),this.currentState=Atlantis.MusicState.PAUSED)};return b}();Atlantis=window.Atlantis||{};Atlantis.Engine=Atlantis.Engine||{};Atlantis.Engine=function(){return{game:null,content:null,stateManager:null,keyboard:null,pointer:null,width:0,height:0}}();
Atlantis.GameApplication=function(){function b(){requestAnimationFrame(b);Atlantis.Engine.game.run()}var a=function(a,b,e){a=new Atlantis.Game(a,b,e);Atlantis.Engine.game=a;Atlantis.Engine.content=a.content;Atlantis.Engine.component=a.components;Atlantis.Engine.keyboard=a.keyboard;Atlantis.Engine.pointer=a.pointer;Atlantis.Engine.width=a.width;Atlantis.Engine.height=a.height;this.initialized=!1;this.stateManager=new Atlantis.StateManager(a);a.components.add(this.stateManager)};a.prototype.run=function(){this.initialized||
(Atlantis.Engine.game.initialize(),this.initialized=!0);b()};return a}();Atlantis=window.Atlantis||{};
Atlantis.Interpolator=function(){var b=function(){this.active=!1;this.interpolatedValue=this.endValue=this.startValue=this.desiredDuration=this.elapsedTime=0};b.prototype.startInterpolation=function(a,b,d){this.startValue=a;this.endValue=b;this.desiredDuration=d;this.elapsedTime=0;this.interpolatedValue=a;this.active=!0};b.prototype.getInterpolatedValue=function(a){this.active&&(this.elapsedTime+=a,this.elapsedTime>=this.desiredDuration?(this.active=!1,this.elapsedTime=this.desiredDuration,this.interpolatedValue=
this.endValue):this.interpolateValue(this.elapsedTime/this.desiredDuration));return this.interpolatedValue};b.prototype.interpolateValue=function(a){var b=this.startValue;a=0>a?0:a;this.interpolatedValue=b+(this.endValue-b)*(1<a?1:a)};return b}();Atlantis=window.Atlantis||{};
Atlantis.State=function(){var b=function(a){this.name=a;this.active=!0;this.stateManager=null;this.assetLoaded=this.initialized=!1;this.visible=this.enabled=!0;this.scene=new Atlantis.SpriteGroup};b.prototype.isActive=function(){return this.visible&&this.enabled};b.prototype.setActive=function(a){this.visible=this.enabled=a};b.prototype.initialize=function(){this.scene.initialize();this.initialized=!0};b.prototype.loadContent=function(a){this.scene.loadContent(a);this.assetLoaded=!0};b.prototype.update=
function(a){this.scene.update(a)};b.prototype.draw=function(a,b){this.scene.draw(a,b)};b.prototype.add=function(a){this.scene.add(a)};b.prototype.remove=function(a){this.scene.remove(a)};b.prototype.get=function(a){return this.scene.get(a)};return b}();
Atlantis.StateManager=function(){var b=function(a){Atlantis.DrawableGameComponent.call(this,a);this.states=[];this.assetLoaded=this.initialized=!1};b.prototype=new Atlantis.DrawableGameComponent;b.prototype.initialize=function(){for(var a=0,b=this.states.length;a<b;a++)this.states[a].initialize();this.initialized=!0};b.prototype.loadContent=function(a){for(var b=0,d=this.states.length;b<d;b++)this.states[b].loadContent(a);this.assetLoaded=!0};b.prototype.update=function(a){for(var b=0,d=this.states.length;b<
d;b++)this.states[b].enabled&&this.states[b].update(a)};b.prototype.draw=function(a,b){for(var d=0,e=this.states.length;d<e;d++)this.states[d].visible&&this.states[d].draw(a,b)};b.prototype.setActive=function(a,b){b&&this.disableStates();if(a instanceof Atlantis.State){var d=this.states.indexOf(a);-1<d&&this.states[d].setActive(!0)}else if("string"==typeof a)for(var e=0,d=-1,g=this.states.length;e<g&&-1==d;)this.states[e].name==a&&(this.states[e].setActive(!0),d=e),e++;else-1<a&&a<this.states.length&&
(this.states[a].active=!0)};b.prototype.disableStates=function(){for(var a=0,b=this.states.length;a<b;a++)this.states[a].active=!1};b.prototype.add=function(a,b,d){d&&this.disableStates();b="undefined"!=typeof b?b:!0;if(a instanceof Array){var e=0;for(d=a.length;e<d;e++)a[e].stateManager=this,a[e].setActive(b),this.initialized&&(a[e].loadContent(this.game.content),a[e].initialize()),this.states.push(a[e])}else a.stateManager=this,a.setActive(b),this.initialized&&(a[e].loadContent(this.game.content),
a[e].initialize()),this.states.push(a)};b.prototype.remove=function(a){var b=null;if(a instanceof Atlantis.state){var d=this.states.indexOf(a);-1<d&&(b=this.states[d],this.states.splice(d,1))}else if("string"==typeof a){for(var e=0,d=-1;e<size&&-1==d;)this.states[e].name==a&&(d=e),e++;-1<d&&(b=this.states[d],this.states.splice(d,1))}else-1<a&&(b=this.states[a],this.states.splice(d,1));return b};b.prototype.get=function(a){var b=null;if("string"==typeof a){for(var d=0,e=-1;d<size&&-1==e;)this.states[d].name==
a&&(e=d),d++;-1<e&&(b=this.states[e])}else-1<b&&(b=this.states[a]);return b};return b}();Atlantis=window.Atlantis||{};Atlantis.StorageManager=function(){function b(a,b){return(b||"Atlantis.Engine")+"."+a}var a=function(){};a.prototype.save=function(a,d,e){"object"==typeof e&&(e=JSON.stringify(e));localStorage.setItem(b(d,a),e)};a.prototype.load=function(a,d,e){a=localStorage.getItem(b(d,a));return null!=a&&e?JSON.parse(a):a};return a}();Atlantis=window.Atlantis||{};
(function(){Atlantis.SpriteAnimation=function(b,a){this.rectangles=Array(b);this.framerate=a;this.index=0;this.max=b;this.elapsedTime=0;this.length=b};Atlantis.SpriteAnimation.prototype.next=function(){return this.rectangles[this.index]};Atlantis.SpriteAnimation.prototype.update=function(b){this.elapsedTime+=b.getElapsedTime();this.elapsedTime>this.framerate&&(this.index++,0==this.index&&Atlantis.notify("atlantis.sprite.animationCompleted"),this.elapsedTime=0)};Atlantis.SpriteAnimator=function(){this.animations=
{};this.spritesheetLength=this.nbSpriteY=this.nbSpriteX=this.textureHeight=this.textureWidth=this.spriteHeight=this.spriteWidth=0;this.currentAnimationName=""};Atlantis.SpriteAnimator.prototype.initialize=function(b,a,c,d){this.animations={};this.spriteWidth=b;this.spriteHeight=a;this.textureWidth=c;this.textureHeight=d;this.nbSpriteX=this.textureWidth/this.spriteWidth;this.nbSpriteY=this.textureHeight/this.spriteHeight;this.spritesheetLength=this.nbSpriteX*this.nbSpriteY;this.currentAnimationName=
""};Atlantis.SpriteAnimator.prototype.add=function(b,a,c){var d=a.length;c=new Atlantis.SpriteAnimation(d,c);if(a instanceof Atlantis.Rectangle)c.rectangles=a;else for(var e=0;e<d;e++){var g=a[e]%this.nbSpriteX,f=Math.floor(a[e]/this.nbSpriteX),g=0<f?g%(this.nbSpriteX*f):g%this.nbSpriteX;c.rectangles[e]=new Atlantis.Rectangle(g*this.spriteWidth,f*this.spriteHeight,this.spriteWidth,this.spriteHeight)}this.animations[b]=c};Atlantis.SpriteAnimator.prototype.play=function(b){this.currentAnimationName=
b;return this.animations[b].next()};Atlantis.SpriteAnimator.prototype.getCurrentAnimation=function(){return""!==this.currentAnimationName?this.animations[this.currentAnimationName]:null};Atlantis.SpriteAnimator.prototype.update=function(b,a){""!==this.currentAnimationName&&this.animations[this.currentAnimationName].update(b)};Atlantis.SpriteAnimator.prototype.checkForIDLEAnimation=function(b){return""!==this.currentAnimationName&&0==b.x&&0==b.y?this.animations[this.currentAnimationName].rectangles[0]:
null}})();Atlantis=window.Atlantis||{};
Atlantis.Entity=function(){var b=function(a){this.visible=this.enabled=!0;this.texture=null;this.textureName="";this.assetLoaded=!1;this.rectangle=new Atlantis.Rectangle;this.sourceRectangle=new Atlantis.Rectangle;Object.defineProperty(this,"x",{get:function(){return this.rectangle.x},set:function(a){this.rectangle.x=a}});Object.defineProperty(this,"y",{get:function(){return this.rectangle.y},set:function(a){this.rectangle.y=a}});Object.defineProperty(this,"width",{get:function(){return this.rectangle.width},set:function(a){this.rectangle.width=
a}});Object.defineProperty(this,"height",{get:function(){return this.rectangle.height},set:function(a){this.rectangle.height=a}});a=a||{};for(var b in a)this[b]=a[b]};b.prototype.initialize=function(){};b.prototype.loadContent=function(a){if(""!=this.textureName&&!1==this.assetLoaded){var b=this;this.texture=a.load(this.textureName);0==this.texture.width&&0==this.texture.height?this.texture.addEventListener("load",function(a){b.updateSizes();b.assetLoaded=!0;Atlantis.notify("Atlantis.Entity.AssetLoaded",
{entity:b.texture})},!1):(this.updateSizes(),this.assetLoaded=!0,Atlantis.notify("Atlantis.Entity.AssetLoaded",{entity:b.texture}))}};b.prototype.update=function(a){};b.prototype.draw=function(a,b){this.visible&&b.drawImage(this.texture,this.rectangle.x,this.rectangle.y,this.rectangle.width,this.rectangle.height)};b.prototype.updateSizes=function(){Atlantis.getImageSize(this.texture);this.rectangle.width=this.texture.width;this.rectangle.height=this.texture.height};b.prototype.setSize=function(a,
b){if(this.assetLoaded)this.rectangle.width=a,this.rectangle.height=b||a;else var d=this,e=setInterval(function(g){d.assetLoaded&&(d.rectangle.width=a,d.rectangle.height=b||a,clearInterval(e))},150)};b.prototype.setPosition=function(a,b){a instanceof Atlantis.Point||a instanceof Atlantis.Rectangle?(this.rectangle.x=a.x,this.rectangle.y=a.y):(this.rectangle.x=a,this.rectangle.y=b||a)};return b}();Atlantis=window.Atlantis||{};
Atlantis.Sprite=function(){var b=function(a){Atlantis.Entity.call(this);this.direction=new Atlantis.Vector2;this.lastPosition=new Atlantis.Vector2;this.lastDistance=new Atlantis.Vector2;this.acceleration=new Atlantis.Vector2(1,1);this.velocity=new Atlantis.Vector2;this.maxVelocity=1;this.viewport=new Atlantis.Rectangle(0,0,Atlantis.Engine.width,Atlantis.Engine.height);this.isFullyLoaded=this.acrossScreen=this.insideScreen=!1;this.spriteAnimator=new Atlantis.SpriteAnimator;this.hasAnimation=!1;this.elapsedTime=
0;a=a||{};for(var b in a)this[b]=a[b]};b.prototype=new Atlantis.Entity;b.prototype.prepareAnimation=function(a,b){this.hasAnimation=!0;var d=b||a;this.spriteAnimator.initialize(a,d,this.texture.width,this.texture.height);this.rectangle.width=a;this.rectangle.height=d};b.prototype.addAnimation=function(a,b,d){this.spriteAnimator.add(a,b,d);this.sourceRectangle=this.spriteAnimator.animations[a].rectangles[0]};b.prototype.play=function(a){this.sourceRectangle=this.spriteAnimator.play(a)};b.prototype.update=
function(a){this.enabled&&(this.elapsedTime+=a.getElapsedTime(),this.lastDistance.x=this.rectangle.x-this.lastPosition.x,this.lastDistance.y=this.rectangle.y-this.lastPosition.y,this.lastPosition.x=this.rectangle.x,this.lastPosition.y=this.rectangle.y,this.rectangle.x+=this.velocity.x*this.acceleration.x,this.rectangle.y+=this.velocity.y*this.acceleration.y,this.velocity.multiply(this.maxVelocity),this.hasAnimation&&(this.spriteAnimator.update(a),0==this.lastDistance.x&&(0==this.lastDistance.y&&""!==
this.spriteAnimator.currentAnimationName)&&(this.sourceRectangle=this.spriteAnimator.getCurrentAnimation().rectangles[0])))};b.prototype.postUpdate=function(a){this.enabled&&(this.direction.x=this.rectangle.x-this.lastPosition.x,this.direction.y=this.rectangle.y-this.lastPosition.y,this.insideScreen?(this.rectangle.x<this.viewport.x?(this.rectangle.x=this.viewport.x,this.velocity.multiply(0)):this.rectangle.getRight()>this.viewport.width&&(this.rectangle.x=this.viewport.width-this.rectangle.width,
this.velocity.multiply(0)),this.rectangle.y<this.viewport.y?(this.rectangle.y=this.viewport.y,this.velocity.multiply(0)):this.rectangle.getBottom()>this.viewport.height&&(this.rectangle.y=this.viewport.height-this.rectangle.height,this.velocity.multiply(0))):this.acrossScreen&&(this.rectangle.getRight()<this.viewport.x?this.rectangle.x=this.viewport.width:this.rectangle.x>this.viewport.width&&(this.rectangle.x=this.viewport.x),this.rectangle.getBottom()<this.viewport.y?this.rectangle.y=this.viewport.height:
this.position.y>this.viewport.height&&(this.rectangle.y=this.viewport.y)))};b.prototype.draw=function(a,b){this.postUpdate(a);this.visible&&this.assetLoaded&&(this.hasAnimation?b.drawImage(this.texture,this.sourceRectangle.x,this.sourceRectangle.y,this.sourceRectangle.width,this.sourceRectangle.height,this.rectangle.x,this.rectangle.y,this.rectangle.width,this.rectangle.height):b.drawImage(this.texture,this.rectangle.x,this.rectangle.y,this.rectangle.width,this.rectangle.height))};return b}();Atlantis=window.Atlantis||{};
Atlantis.SpriteGroup=function(){var b=function(){Atlantis.Entity.call(this);this.entities=[]};b.prototype=new Atlantis.Entity;b.prototype.initialize=function(){for(var a=0,b=this.entities.length;a<b;a++)this.entities[a].initialize()};b.prototype.loadContent=function(a){for(var b=0,d=this.entities.length;b<d;b++)this.entities[b].loadContent(a)};b.prototype.update=function(a){if(this.enabled)for(var b=0,d=this.entities.length;b<d;b++)this.entities[b].update(a)};b.prototype.draw=function(a,b){if(this.visible)for(var d=
0,e=this.entities.length;d<e;d++)this.entities[d].draw(a,b)};b.prototype.add=function(a){if(a instanceof Array)for(var b=0,d=a.length;b<d;b++)this.entities.push(a[b]);else this.entities.push(a)};b.prototype.remove=function(a){var b=null;if(a instanceof Atlantis.Entity){var d=this.entities.indexOf(a);-1<d&&(b=this.entities[d],this.entities.splice(d,1))}else-1<a&&(b=this.entities[d],this.entities.splice(d,1));return b};b.prototype.get=function(a){var b=null;-1<a&&(b=this.entities[a]);return b};return b}();
