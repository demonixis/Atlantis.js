var Atlantis=window.Atlantis||{};Atlantis.MusicState=Atlantis.MusicState||{};
(function(){Atlantis.MusicState.PLAYING=1;Atlantis.MusicState.STOPPED=2;Atlantis.MusicState.PAUSED=3;Atlantis.AudioManager=function(){this.repeatMusic=!1;this.currentMusic=null;this.volume=1;this.currentState=Atlantis.MusicState.STOPPED};Atlantis.AudioManager.prototype.playMusic=function(a,b){this.stopMusic();this.currentMusic=a;this.repeat=b;this.currentMusic.play()};Atlantis.AudioManager.prototype.stopMusic=function(){};Atlantis.AudioManager.prototype.pauseMusic=function(){null!=this.currentMusic&&
this.currentState==Atlantis.MusicState.PLAYING&&this.currentMusic.pause()};Atlantis.AudioManager.prototype.playSound=function(){}})();Atlantis=window.Atlantis||{};
(function(){Atlantis.ContentManager=function(a){this.rootDirectory=a||"";this.assets=[]};Atlantis.ContentManager.prototype.load=function(a){if("undefined"==typeof this.assets[a]){var b=a.split("."),c=b[b.length-1];switch(c){case "png":case "jpg":case "bmp":var b=this.assets,d=new Image;d.src=a;b[a]=d;break;case "mp3":case "ogg":case "wav":b=this.assets;d=document.createElement("audio");d.src=a;d.controls=!1;b[a]=d;break;case "mp4":case "ogv":b=this.assets,d=document.createElement("video"),d.src=a,
b[a]=d;case "xml":case "json":case "js":var e=this.assets;"undefined"!=typeof Atlantis.ajax?Atlantis.ajax({method:"GET",url:a,success:function(b){var d=b;"json"==c&&(d=JSON.parse(b));e[a]=d}}):console.error("[Content] Impossible to load the resource becanse the Atlantis.Helper class isn't loaded")}}return this.assets[a]};Atlantis.ContentManager.prototype.dispose=function(){this.assets=[]}})();Atlantis=window.Atlantis||{};
(function(){Atlantis.GameComponent=function(a){this.game=a};Atlantis.GameComponent.prototype.initialize=function(){};Atlantis.GameComponent.prototype.update=function(){};Atlantis.DrawableGameComponent=function(a){Atlantis.GameComponent.call(this,a)};Atlantis.DrawableGameComponent.prototype=new Atlantis.GameComponent;Atlantis.GameComponent.prototype.draw=function(){};Atlantis.GameComponentCollection=function(){this.components=[]};Atlantis.GameComponentCollection.prototype.add=function(a){-1==this.components.indexOf(a)&&
this.components.push(a)};Atlantis.GameComponentCollection.prototype.get=function(a){a=this.components.indexOf(a);return-1<a?this.components[a]:null};Atlantis.GameComponentCollection.prototype.remove=function(a){a=this.components.indexOf(a);-1<a&&this.components.splice(a,1)};Atlantis.GameComponentCollection.prototype.loadContent=function(a){for(var b=0,c=this.components.length;b<c;b++)this.components[b].loadContent(a)};Atlantis.GameComponentCollection.prototype.update=function(a){for(var b=0,c=this.components.length;b<
c;b++)this.components[b].update(a)};Atlantis.GameComponentCollection.prototype.draw=function(a,b){for(var c=0,d=this.components.length;c<d;c++)this.components[c]instanceof Atlantis.DrawableGameComponent&&this.components[c].draw(a,b)}})();Atlantis=window.Atlantis||{};Atlantis.Graphics=Atlantis.Graphics||{};(function(){Atlantis.Graphics.drawCircle=function(a,b,c,d,e){a.beginPath();a.arc(b,c,d,0,2*Math.PI,!0);a.fillStyle=e||"#ffffff";a.fill()};Atlantis.Graphics.drawRectPoint=function(a,b,c,d,e,f){a.fillStyle=f||"#ffffff";a.fillRect(b,c,d,e)};Atlantis.Graphics.drawText=function(a,b,c,d,e){e=e||{};var f=e.style||"normal",g=e.size||12,h=e.font||"sans-serif";a.fillStyle=e.color||"#ffffff";a.font=f+" "+g+"px "+h;a.fillText(b,c,d)}})();Atlantis=window.Atlantis||{};
(function(){var a=[];Atlantis.ajax=function(a){var c=parameters.url,d=parameters.method||"GET";a=parameters.params||"";var e=parameters.success||null,f=new XMLHttpRequest;"POST"==d?(f.open("POST",c,!0),f.setRequestHeader("Content-type","application/x-www-form-urlencoded"),f.setRequestHeader("Content-length",a.length),f.setRequestHeader("Connection","close"),f.onreadystatechange=function(){4==f.readyState&&200==f.status&&null!=e&&e(f.responseText)},f.send(a)):(f.open("GET",""!=a?c+"?"+a:c,!0),f.onreadystatechange=
function(){4==f.readyState&&null!=e&&e(f.responseText)},f.send(null))};Atlantis.notify=function(b,c){if("undefined"!=typeof a[b]){var d=a[b];if(c instanceof Object)for(var e in c)d[e]=c[e];document.dispatchEvent(d)}else return a[b]=document.createEvent("HTMLEvents"),a[b].initEvent(b,!0,!1),Atlantis.notify(b,c)};Atlantis.getImageSize=function(a){a.style.position="absolute";a.style.left="-9999px";document.body.appendChild(a);document.body.removeChild(a);a.style.position="";a.style.left=""}})();Atlantis=Atlantis||{};
(function(){Atlantis.Point=function(a,b){this.x=a||0;this.y=b||0};Atlantis.Rectangle=function(a,b,c,d){this.x=a||0;this.y=b||0;this.width=c||0;this.height=d||0};Atlantis.Rectangle.prototype.getTop=function(){return this.y};Atlantis.Rectangle.prototype.getBottom=function(){return this.y+this.height};Atlantis.Rectangle.prototype.getLeft=function(){return this.x};Atlantis.Rectangle.prototype.getRight=function(){return this.x+this.width};Atlantis.Rectangle.prototype.getCenter=function(){return new Atlantis.Point(this.x+this.width/
2,this.y+this.height/2)};Atlantis.Rectangle.prototype.contains=function(a){return a instanceof Atlantis.Point?this.x<=a.x&&a.x<this.getRight()&&this.y<=a.y&&a.y<this.getBottom():a instanceof Atlantis.Rectangle?this.x<=a.x&&a.getRight()<=this.getRight()&&this.y<=a.y&&a.getBottom()<=this.getBottom():!1};Atlantis.Rectangle.prototype.intersects=function(a){return a.getLeft()<this.getRight()&&this.getLeft()<a.getRight()&&a.getTop()<this.getBottom()&&this.getTop()<a.getBottom()}})();Atlantis=window.Atlantis||{};
(function(){Atlantis.Vector2=function(a,b){this.x=a||0;this.y=b||0};Atlantis.Vector2.prototype.add=function(a){a instanceof Atlantis.Vector2?(this.x+=a.x,this.y+=a.y):(this.x+=a,this.y+=a)};Atlantis.Vector2.prototype.subtract=function(a){a instanceof Atlantis.Vector2?(this.x-=a.x,this.y-=a.y):(this.x-=a,this.y-=a)};Atlantis.Vector2.prototype.divide=function(a){a instanceof Atlantis.Vector2?(this.x/=a.x,this.y/=a.y):(this.x/=a,this.y/=a)};Atlantis.Vector2.prototype.multiply=function(a){a instanceof
Atlantis.Vector2?(this.x*=a.x,this.y*=a.y):(this.x*=a,this.y*=a)};Atlantis.Vector2.prototype.negate=function(a){a instanceof Atlantis.Vector2?(this.x=-a.x,this.y=-a.y):(this.x=-a,this.y=-a)};Atlantis.Vector2.prototype.normalize=function(){var a=1/(Math.sqrt(this.x*this.x)+this.y*this.y);this.x*=a;this.y*=a};Atlantis.Vector2.prototype.getDistance=function(a){var b=this.x-a.x;a=this.y-a.y;return Math.sqrt(b*b+a*a)}})();var Atlantis=window.Atlantis||{},Keys=window.Keys||{};
(function(){Keys={up:38,down:40,left:37,right:39,space:32,escape:27};Atlantis.KeyboardState=function(){this.keys=[];for(var a=0;110>a;a++)this.keys[a]=!1};Atlantis.KeyboardState.prototype.initialize=function(){for(var a=this.keys,b=0;110>b;b++)a[b]=!1;var c=this;document.addEventListener("keydown",function(a){c.onKeyStateChange(a,c)},!1);document.addEventListener("keyup",function(a){c.onKeyStateChange(a,c)},!1)};Atlantis.KeyboardState.prototype.onKeyStateChange=function(a,b){b.keys[a.keyCode]="keydown"==
a.type?!0:!1}})();Atlantis=window.Atlantis||{};
(function(){function a(a,c){var d;d="undefined"!=typeof a.touches&&0<a.touches.length?a.touches[0]:a;c.last.x=this.x;c.last.y=this.y;c.x=d.pageX;c.y=d.pageY}Atlantis.MouseState=function(){this.y=this.x=0;this.last={x:0,y:0};this.delta={x:0,y:0};this.click=!1;this.release=!0;this.drag=!1;this.domElement=document;this.initialized=!1};Atlantis.MouseState.prototype.initialize=function(){if(!this.initialized){var a=this;this.domElement.addEventListener("mousedown",function(c){a.update(c,a)},!1);this.domElement.addEventListener("mousemove",
function(c){a.update(c,a)},!1);this.domElement.addEventListener("mouseup",function(c){a.update(c,a)},!1);this.domElement.addEventListener("click",function(c){a.update(c,a)},!1);this.domElement.addEventListener("touchstart",function(c){a.update(c,a)},!1);this.domElement.addEventListener("touchmove",function(c){a.update(c,a)},!1);this.domElement.addEventListener("touchend",function(c){a.update(c,a)},!1);this.domElement.addEventListener("touchcancer",function(c){a.update(c,a)},!1);this.initialized=!0}};
Atlantis.MouseState.prototype.update=function(b,c){b.preventDefault();a(b,c);"mousedown"==b.type||"touchstart"==b.type?(c.click=!0,c.release=!1):"mousemove"==b.type||"touchmove"==b.type?c.drag=c.click?!0:!1:"mouseup"==b.type||"touchend"==b.type?(c.click=!1,c.release=!0,c.drag=!1):"click"==b.type&&(c.click=!1,c.release=!0,c.drag=!1);c.delta.x=c.x-c.last.x;c.delta.y=c.y-c.last.y}})();Atlantis=window.Atlantis||{};(function(){Atlantis.TouchState=function(){}})();Atlantis=window.Atlantis||{};Atlantis.Engine=Atlantis.Engine||{};
(function(){function a(){requestAnimationFrame(a);Atlantis.Engine.game.run()}Atlantis.Engine.game=null;Atlantis.Engine.content=null;Atlantis.Engine.components=null;Atlantis.Engine.stateManager=null;Atlantis.Engine.keyboard=null;Atlantis.Engine.mouse=null;Atlantis.Engine.touch=null;Atlantis.Engine.width=0;Atlantis.Engine.height=0;Atlantis.Engine.width=0;Atlantis.Engine.height=0;Atlantis.Engine=function(a,c,d){a=new Atlantis.Game(a,c,d);Atlantis.Engine.game=a;Atlantis.Engine.content=a.content;Atlantis.Engine.component=
a.components;Atlantis.Engine.keyboard=a.keyboard;Atlantis.Engine.mouse=a.mouse;Atlantis.Engine.touch=a.touch;Atlantis.Engine.width=a.width;Atlantis.Engine.height=a.height;this.stateManager=new Atlantis.StateManager(a);a.components.add(this.stateManager)};Atlantis.Engine.prototype.run=function(){Atlantis.Engine.game.initialize();a()}})();Atlantis=window.Atlantis||{};Atlantis.Engine=Atlantis.Engine||{};
(function(){Atlantis.State=function(a){this.name=a;this.active=!0;this.stateManager=null;this.initialized=!1;this.scene=new Atlantis.SpriteGroup};Atlantis.State.prototype.loadContent=function(a){this.scene.loadContent(a);this.scene.initialize();this.initialized=!0};Atlantis.State.prototype.update=function(a){this.scene.update(a)};Atlantis.State.prototype.draw=function(a,b){this.scene.draw(a,b)};Atlantis.StateManager=function(a){Atlantis.DrawableGameComponent.call(this,a);this.states=[];this.initialized=
!1};Atlantis.StateManager.prototype=new Atlantis.DrawableGameComponent;Atlantis.StateManager.prototype.loadContent=function(a){for(var b=0,c=this.states.length;b<c;b++)this.states[b].loadContent(a),this.initialized=!0};Atlantis.StateManager.prototype.update=function(a){for(var b=0,c=this.states.length;b<c;b++)this.states[b].active&&this.states[b].update(a)};Atlantis.StateManager.prototype.draw=function(a,b){for(var c=0,d=this.states.length;c<d;c++)this.states[c].active&&this.states[c].draw(a,b)};
Atlantis.StateManager.prototype.setStateActive=function(a,b){"undefined"!=typeof b&&!0==b&&this.disableStates();if(a instanceof Atlantis.State){var c=this.states.indexOf(a);-1<c&&(this.states[c].active=!0)}else if("string"==typeof a)for(var d=0,c=-1,e=this.states.length;d<e&&-1==c;)this.states[d].name==a&&(this.states[d].active=!0,c=d),d++;else-1<a&&(this.states[a].active=!0)};Atlantis.StateManager.prototype.disableStates=function(){for(var a=0,b=this.states.length;a<b;a++)this.states[a].active=!1};
Atlantis.StateManager.prototype.switchState=function(a){this.states=[];this.states.push(a)};Atlantis.StateManager.prototype.add=function(a,b,c){"undefined"!=typeof c&&!0==c&&this.disableStates();if(a instanceof Array){var d=0;for(c=a.length;d<c;d++)a[d].stateManager=this,a[d].active=b,this.initialized&&(a[d].loadContent(this.game.content),a[d].initialize()),this.states.push(a[d])}else a.stateManager=this,a.active=b,this.initialized&&(a[d].loadContent(this.game.content),a[d].initialize()),this.states.push(a)};
Atlantis.StateManager.prototype.remove=function(a){var b=null;if(a instanceof Atlantis.state){var c=this.states.indexOf(a);-1<c&&(b=this.states[c],this.states.splice(c,1))}else-1<a&&(b=this.states[a],this.states.splice(c,1));return b};Atlantis.StateManager.prototype.get=function(a){var b=null;if(a instanceof Atlantis.State){var c=this.states.indexOf(a);-1<c&&(b=this.states[c])}else if("string"==typeof a){for(var d=0,c=-1;d<size&&-1==c;)this.states[d].name==a&&(c=d),d++;-1<c&&(b=this.states[c])}else-1<
b&&(b=this.states[a]);return b}})();Atlantis=window.Atlantis||{};
(function(){Atlantis.SpriteAnimation=function(a,b){this.rectangles=Array(a);this.frameRate=b;this.index=0;this.max=a;this.elapsedTime=0;this.length=a};Atlantis.SpriteAnimation.prototype.next=function(a){this.elapsedTime+=a;this.elapsedTime>this.frameRate&&(this.index++,this.index>=this.max&&(this.index=0),0==this.index&&Atlantis.notify("sprite.AnimationComplete"),this.elapsedTime=0);return this.rectangles[this.index]};Atlantis.SpriteAnimator=function(){this.animations={};this.spritesheetLength=this.nbSpriteY=
this.nbSpriteX=this.textureHeight=this.textureWidth=this.spriteHeight=this.spriteWidth=0};Atlantis.SpriteAnimator.prototype.initialize=function(a,b,c,d){this.animations={};this.spriteWidth=a;this.spriteHeight=b;this.textureWidth=c;this.textureHeight=d;this.nbSpriteX=this.textureWidth/this.spriteWidth;this.nbSpriteY=this.textureHeight/this.spriteHeight;this.spritesheetLength=this.nbSpriteX*this.nbSpriteY};Atlantis.SpriteAnimator.prototype.add=function(a,b,c){var d=b.length;c=new Atlantis.SpriteAnimation(d,
c);if(b instanceof Atlantis.Rectangle)c.rectangles=b;else for(var e=0;e<d;e++){var f=b[e]%this.nbSpriteX,g=Math.floor(b[e]/this.nbSpriteX),f=0<g?f%(this.nbSpriteX*g):f%this.nbSpriteX;c.rectangles[e]=new Atlantis.Rectangle(f*this.spriteWidth,g*this.spriteHeight,this.spriteWidth,this.spriteHeight)}this.animations[a]=c};Atlantis.SpriteAnimator.prototype.update=function(){}})();Atlantis=window.Atlantis||{};
(function(){Atlantis.Entity=function(a){this.visible=this.enabled=!0;this.texture=null;this.textureName="";this.assetLoaded=!1;this.rectangle=new Atlantis.Rectangle;this.sourceRectangle=new Atlantis.Rectangle;a=a||{};for(var b in a)this[b]=a[b]};Atlantis.Entity.prototype.initialize=function(){};Atlantis.Entity.prototype.loadContent=function(a){if(""!=this.textureName&&!1==this.assetLoaded){var b=this;this.texture=a.load(this.textureName);0==this.texture.width&&0==this.texture.height?this.texture.addEventListener("load",
function(){b.updateSizes();b.assetLoaded=!0;Atlantis.notify("Atlantis.Entity.AssetLoaded",{entity:b.texture})},!1):(this.updateSizes(),this.assetLoaded=!0,Atlantis.notify("Atlantis.Entity.AssetLoaded",{entity:b.texture}))}};Atlantis.Entity.prototype.update=function(){};Atlantis.Entity.prototype.draw=function(a,b){this.visible&&b.drawImage(this.texture,this.rectangle.x,this.rectangle.y,this.rectangle.width,this.rectangle.height)};Atlantis.Entity.prototype.updateSizes=function(){Atlantis.getImageSize(this.texture);
this.rectangle.width=this.texture.width;this.rectangle.height=this.texture.height};Atlantis.Entity.prototype.setSize=function(a,b){if(this.assetLoaded)this.rectangle.width=a,this.rectangle.height=b||a;else var c=this,d=setInterval(function(){c.assetLoaded&&(c.rectangle.width=a,c.rectangle.height=b||a,clearInterval(d))},150)};Atlantis.Entity.prototype.setPosition=function(a,b){a instanceof Atlantis.Point||a instanceof Atlantis.Rectangle?(this.position.x=a.x,this.position.y=a.y,this.rectangle.x=a.x,
this.rectangle.y=a.y):(this.position.x=a,this.position.y=b||a,this.rectangle.x=a,this.rectangle.y=b||a)}})();Atlantis=window.Atlantis||{};
(function(){Atlantis.Sprite=function(a){Atlantis.Entity.call(this);this.position=new Atlantis.Vector2;this.direction=new Atlantis.Vector2;this.lastPosition=new Atlantis.Vector2;this.lastDistance=new Atlantis.Vector2;this.acceleration=new Atlantis.Vector2(1,1);this.velocity=new Atlantis.Vector2;this.maxVelocity=1;this.viewport=new Atlantis.Rectangle;this.isFullyLoaded=this.acrossScreen=this.insideScreen=!1;this.spriteAnimator=new Atlantis.SpriteAnimator;this.hasAnimation=!1;this.elapsedTime=0;a=a||
{};for(var b in a)this[b]=a[b]};Atlantis.Sprite.prototype=new Atlantis.Entity;Atlantis.Sprite.prototype.prepareAnimation=function(a,b){this.hasAnimation=!0;var c=b||a;this.spriteAnimator.initialize(a,c,this.texture.width,this.texture.height);this.rectangle.width=a;this.rectangle.height=c};Atlantis.Sprite.prototype.addAnimation=function(a,b,c){this.spriteAnimator.add(a,b,c);this.sourceRectangle=this.spriteAnimator.animations[a].rectangles[0]};Atlantis.Sprite.prototype.play=function(a){this.sourceRectangle=
this.spriteAnimator.animations[a].next(this.elapsedTime)};Atlantis.Sprite.prototype.update=function(a){this.enabled&&(this.elapsedTime+=a.getElapsedTime(),this.lastDistance.x=this.position.x-this.lastPosition.x,this.lastDistance.y=this.position.y-this.lastPosition.y,this.lastPosition.x=this.position.x,this.lastPosition.y=this.position.y,this.position.x+=this.velocity.x*this.acceleration.x,this.position.y+=this.velocity.y*this.acceleration.y,this.velocity.multiply(this.maxVelocity),this.rectangle.x=
this.position.x,this.rectangle.y=this.position.y,this.hasAnimation&&this.spriteAnimator.update(a,this.lastDistance))};Atlantis.Sprite.prototype.postUpdate=function(){this.enabled&&(this.direction.x=this.position.x-this.lastPosition.x,this.direction.y=this.position.y-this.lastPosition.y,this.insideScreen?(this.position.x<this.viewport.x?(this.position.x=this.viewport.x,this.velocity.multiply(0)):this.rectangle.getRight()>this.viewport.width&&(this.position.x=this.viewport.width-this.rectangle.width,
this.velocity.multiply(0)),this.position.y<this.viewport.y?(this.position.y=this.viewport.y,this.velocity.multiply(0)):this.rectangle.getBottom()>this.viewport.height&&(this.position.y=this.viewport.height-this.rectangle.height,this.velocity.multiply(0))):this.acrossScreen&&(this.rectangle.getRight()<this.viewport.x?this.position.x=this.viewport.width:this.position.x>this.viewport.width&&(this.position.x=this.viewport.x),this.rectangle.getBottom()<this.viewport.y?this.position.y=this.viewport.height:
this.position.y>this.viewport.height&&(this.position.y=this.viewport.y)))};Atlantis.Sprite.prototype.draw=function(a,b){this.postUpdate(a);this.visible&&this.assetLoaded&&(this.hasAnimation?b.drawImage(this.texture,this.sourceRectangle.x,this.sourceRectangle.y,this.sourceRectangle.width,this.sourceRectangle.height,this.rectangle.x,this.rectangle.y,this.rectangle.width,this.rectangle.height):b.drawImage(this.texture,this.rectangle.x,this.rectangle.y,this.rectangle.width,this.rectangle.height))}})();Atlantis=window.Atlantis||{};
(function(){Atlantis.SpriteGroup=function(){Atlantis.Entity.call(this);this.entities=[]};Atlantis.SpriteGroup.prototype=new Atlantis.Entity;Atlantis.SpriteGroup.prototype.initialize=function(){for(var a=0,b=this.entities.length;a<b;a++)this.entities[a].initialize()};Atlantis.SpriteGroup.prototype.loadContent=function(a){for(var b=0,c=this.entities.length;b<c;b++)this.entities[b].loadContent(a)};Atlantis.SpriteGroup.prototype.update=function(a){if(this.enabled)for(var b=0,c=this.entities.length;b<
c;b++)this.entities[b].update(a)};Atlantis.SpriteGroup.prototype.draw=function(a,b){if(this.visible)for(var c=0,d=this.entities.length;c<d;c++)this.entities[c].draw(a,b)};Atlantis.SpriteGroup.prototype.add=function(a){if(a instanceof Array)for(var b=0,c=a.length;b<c;b++)this.entities.push(a[b]);else this.entities.push(a)};Atlantis.SpriteGroup.prototype.remove=function(a){var b=null;if(a instanceof Atlantis.Entity){var c=this.entities.indexOf(a);-1<c&&(b=this.entities[c],this.entities.splice(c,1))}else-1<
a&&(b=this.entities[c],this.entities.splice(c,1));return b};Atlantis.SpriteGroup.prototype.get=function(a){var b=null;if(a instanceof Atlantis.Entity){var c=this.entities.indexOf(a);-1<c&&(b=this.entities[c])}else-1<a&&(b=this.entities[c]);return b}})();
