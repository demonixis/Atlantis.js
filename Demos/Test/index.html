<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <title>AtlantisEngine.js - Samples</title>
        <style>
            html, body { margin: 0; padding: 0; border: 0; text-align: center; }
        </style>
        <link rel="icon" href="../web/favicon.png" />
    </head>
    <body>
        <div class="container"></div>
        <!-- Framework -->
        <script src="../../Framework/Compatibility.js"></script>
        <script src="../../Framework/Common.js"></script>
        <script src="../../Framework/ContentManager.js"></script>
        <script src="../../Framework/GameComponent.js"></script>
        <script src="../../Framework/GameTime.js"></script>
        <script src="../../Framework/MathHelper.js"></script>
        <script src="../../Framework/Rectangle.js"></script>
        <script src="../../Framework/Matrix.js"></script>
        <script src="../../Framework/Quaternion.js"></script>
        <script src="../../Framework/Vector2.js"></script>
        <script src="../../Framework/Vector3.js"></script>
        <script src="../../Framework/Vector4.js"></script>
        <script src="../../Framework/Input/Keyboard.js"></script>
        <script src="../../Framework/Input/Mouse.js"></script>
        <script src="../../Framework/Input/TouchPanel.js"></script>
        <script src="../../Framework/Input/Gamepad.js"></script>
        <script src="../../Framework/Input/Keys.js"></script>
        <script src="../../Framework/Graphics/GraphicsDevice.js"></script>
        <script src="../../Framework/Graphics/SpriteBatch.js"></script>
        <script src="../../Framework/Graphics/RenderTarget.js"></script>
        <script src="../../Framework/Graphics/SpriteBatch.js"></script>
        <script src="../../Framework/Graphics/SpriteFont.js"></script>
        <script src="../../Framework/Preloader.js"></script>
        <script src="../../Framework/Game.js"></script>
        <!-- Engine -->
        <script src="../../Engine/Random.js"></script>
        <script src="../../Engine/AudioManager.js"></script>
        <script src="../../Engine/StorageManager.js"></script>
        <script src="../../Engine/StateManager.js"></script>
        <script src="../../Engine/Graphics/Animation.js"></script>
        <script src="../../Engine/Graphics/Camera2D.js"></script>
        <script src="../../Engine/Graphics/Sprite.js"></script>
        <script src="../../Engine/Graphics/SpriteGroup.js"></script>
        <script src="../../Engine/Graphics/Scene2D.js"></script>
        <script src="../../Engine/Graphics/Tilemap.js"></script>
        <script src="../../Engine/Graphics/TmxLoader.js"></script>
        <script src="../../Engine/Input/KeyboardComponent.js"></script>
        <script src="../../Engine/GameApplication.js"></script>

    </body>
    <script>
        // The Game class
        var TestGame = function () {
            Atlantis.GameApplication.call(this, 640, 480);
            this.content.rootDirectory = "Content/";
            this.spriteBatch = new Atlantis.SpriteBatch(this.graphicsDevice);
            this.player = new Atlantis.Sprite("Player.png");
            this.scene = new Atlantis.Scene2D();

            this.content.preloader.push("Player.png");
        };
        TestGame.prototype = Object.create(Atlantis.GameApplication.prototype);

        // Load you assets here.
        TestGame.prototype.loadContent = function () {
            Atlantis.GameApplication.prototype.loadContent.call(this);
            this.player.initialize();
            this.player.loadContent(this.content);
            this.player.move(300, 200);
            this.player.collisionType = Atlantis.SpriteCollisionType.Stop;

            this.scene.initialize();
            this.scene.loadContent(this.content);

            var createSprite = function (x, y) {
                var sprite = new Atlantis.Sprite("Player.png");
                sprite.initialize();
                sprite.loadContent(this.content);
                sprite.x = x;
                sprite.y = y;
                return sprite;
            }.bind(this);

            this.scene.add(createSprite(10, 10));
            this.scene.add(createSprite(10, 50));
            this.scene.add(createSprite(10, 100));
            this.scene.add(createSprite(10, 140));
            this.scene.add(createSprite(10, 190));
            this.scene.add(createSprite(10, 240));
        };

        // Update the game logic here as Input, Physics, etc.
        TestGame.prototype.update = function (gameTime) {
            Atlantis.GameApplication.prototype.update.call(this, gameTime);
            
            this.player.update(gameTime);
            
            this.scene.update(gameTime);
      
            if (Atlantis.input.keys.pressed(Atlantis.Keys.Up)) {
                  this.player.y -= 5;
            }
            else if (Atlantis.input.keys.pressed(Atlantis.Keys.Down)) {
                this.player.y += 5;
            }

            if (Atlantis.input.keys.pressed(Atlantis.Keys.Left)) {
               this.player.x -= 5;
            }
            else if (Atlantis.input.keys.pressed(Atlantis.Keys.Right)) {
                this.player.x += 5;
            }

            if (Atlantis.input.keys.pressed(Atlantis.Keys.Z)) {
                  this.scene.y -= 5;
            }
            else if (Atlantis.input.keys.pressed(Atlantis.Keys.S)) {
                this.scene.y += 5;
            }

            if (Atlantis.input.keys.pressed(Atlantis.Keys.Q)) {
               this.scene.x -= 5;
            }
            else if (Atlantis.input.keys.pressed(Atlantis.Keys.D)) {
                this.scene.x += 5;
            }

            this.scene.collides(this.player);

            this.player.postUpdate(gameTime);
        };

        TestGame.prototype.draw = function(gameTime) {
            Atlantis.GameApplication.prototype.draw.call(this, gameTime);
            this.graphicsDevice.clear();
            this.spriteBatch.begin();
            this.player.draw(this.spriteBatch);
            this.scene.draw(this.spriteBatch);
            this.spriteBatch.end();
        }

        // Start the game !
        var game = new TestGame();
        game.run();
    </script>
</html>
